ئورد  ErrorManager ك مديرخطئ من '/ErrorManager.mjs'؛
ئورد '/ImportManager.mjs'؛
ئورد '/Scope.mjs'؛
ئورد '/Symbol.mjs'؛
ئورد '/SymbolScopes.mjs'؛
ئورد '/vfs.mjs'؛

ئورد نتجقاب، بتشدبي، بتشمرفق من مكون.بتشدبي؛
ئورد createParser ك ئنشئمحلل من '/jparser.mjs'؛
ئورد vfs ك نفف من '/vfs.mjs'؛

ئورد قابمحلي من قاعدب؛

ئورد الكل ك مجالبطاقة من صنفمجال.بطاقة؛
ئورد مختطبطاقة من صنفمجال.بطاقة؛
ئورد مختطوحدة من صنفمجال.وحدة؛


ئعلن ئدمجبطاقات (نصية مساروحدة) ك وعد مركب {نصية مسار، نصية محتوا}:
	مركب {نصية مسار، نصية محتوا} نتيجة؛
	نتجقاب نتج = ريتما قابمحلي.ئستعلم(
		حدد: {
			نوع: 'بطاقة'،
			وحدة: مساروحدة
		}
	)؛
	مختطبطاقة[] بطاقات = نتج.وتيقات؛
	بطاقات.رتتب(دالة(مختطبطاقة ئ، مختطبطاقة ب): ئ.رتبة - ب.رتبة)؛
	
	#مختطبطاقة[] بطائوردين = بطاقات.رششح(دالة (مختطبطاقة بط): بط.نوعبطاقة == 'ئوردين')؛
	#مختطبطاقة[] بطامتغيرين = بطاقات.رششح(دالة (مختطبطاقة بط): بط.نوعبطاقة == 'متغيرين')؛
	#مختطبطاقة[] بطامركبين = بطاقات.رششح(دالة (مختطبطاقة بط): بط.نوعبطاقة == 'مركبين')؛
	#مختطبطاقة[] بطاوضيفة = بطاقات.رششح(دالة (مختطبطاقة بط): بط.نوعبطاقة == 'وضيفة')؛
	
	#نصية[] ئوردين = بطائوردين.طببق(دالة (مختطبطاقة بط): بط.محتوا)؛
	#نصية[] متغيرين = بطامتغيرين.طببق(دالة (مختطبطاقة بط): بط.محتوا)؛
	#نصية[] وضيفات = بطاوضيفة.طببق(دالة (مختطبطاقة بط): بط.محتوا)؛
	#نصية محتوا = ئوردين.ئدمج('\n') + متغيرين.ئدمج('\n') + وضيفات.ئدمج('\n')؛
	
	نصية[] محتوين = بطاقات.طببق(دالة (مختطبطاقة بط): بط.محتوا)؛
	نصية محتوا = محتوين.ئدمج('\n\n')؛

	نتيجة = {
		مسار: مساروحدة،
		محتوا: محتوا
	}؛
	ئرجع نتيجة؛
تم

ئعلن ترجم (نصية مساروحدة) ك وعد:
	#يئخد مسار وحدة مدخل التنفيد
	نصية كود؛
	دع نتيجة؛
	دع محلل = ئنشئمحلل()؛
	
	#حدف ما سلف
	ريتما نفف.ئعدئنشائ(نفف.ردمجلدخام())؛
	
	مديرخطئ['clear']()؛
		
	#تحليل الوحدة الرئيسية المعطاة
	مركب {نصية مسار، نصية محتوا} نتج = ريتما ئدمجبطاقات(مساروحدة)؛
	كود = نتج.محتوا؛

	نتيجة = ريتما محلل.parse(كود، {
		filePath: نفف.حلل(مساروحدة)،
		projectPath: نفف.ردمجلدمشروع()،
		outPath: نفف.ردمجلدخام()
	})؛
	
تم
