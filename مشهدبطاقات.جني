ئورد مكون، عنصرمخصص، عنصرئدخال، عنصر، عنصرئشتمل؛
ئورد النافدة من نافدة؛
ئورد المستند من مستند؛

ئورد نتجقاب، بتشدبي من مكون.بتشدبي؛
ئورد شبكي من مكون.شبكي؛
ئورد طافية من مكون.طافية؛

ئورد مشهدبطاقة، عنصربطاقة؛

ئورد قابمحلي من قاعدب؛
ئورد مختطبطاقة من مختطة؛

ئعلن مشهدبطاقات ():
	يمدد مكون()؛
	يملك مركب { مختطبطاقة[] بطاقات } حالة = {
		بطاقات: []
	}؛
	يملك مختطبطاقة[] ئاخرمفتوح = []؛
تم

ئعلن مشهدبطاقات.حممل () ك وعد:
	نتجقاب نتج = ريتما قابمحلي.ئستعلم(
		حدد: {
			نوع: 'بطاقة'
		}
	)؛
	هدا.خدحالة({
		بطاقات: نتج.وتيقات
	})؛
تم

ئعلن مشهدبطاقات.ئغلاقبطاقة(نصية معرف) ك وعد:
	مختطبطاقة بطاقتي = ريتما قابمحلي.ئجلب(معرف)؛
	عنصربطاقة عنصربطا = هدا.ئستعلم("#_%{معرف}")؛
	عنصربطا.خدحالة({
		بطاقة: بطاقتي
	})؛
تم

ئعلن مشهدبطاقات.عندنقرفتحبطاقة (عنصرئشتمل هدف) ك وعد:
	طافية طاف = هدا.ئستعلم((<طافية>))؛
	نصية معرفبطاقة = هدف.ردخاصية('بيا-معرف')؛
	مختطبطاقة بطاقتي = ريتما قابمحلي.ئجلب(معرفبطاقة)؛
	هدا.ئاخرمفتوح = هدا.ئاخرمفتوح.رششح(دالة(بط): بط._معرف لا= معرفبطاقة)؛
	هدا.ئاخرمفتوح.ئستزح(بطاقتي)؛
	طاف.خدحالة({
		جسم: 'مشهدبطاقة'،
		بيا: {
			بطاقة: بطاقتي
		}
	})؛
	طاف.ئضفمستمعحدت('ئغلاقطافية'، دالة(): هدا.ئغلاقبطاقة(معرفبطاقة))؛
تم

ئعلن مشهدبطاقات.صيير ():
	مختطبطاقة بطاقة؛
	نصية طنافدة = "height:%{النافدة.طولداخلي - 60}px"؛
	ئرجع (
		<قسم صنف="حشس-4 فائضس-مخفي فائضص-تلقا خلف-حيادي-900">
			<قسم سمة="%{طنافدة};touch-action:pan-y">
				<شبكي عموصغ="2" عموسط="3" عموكب="4" فجوة="10 10" ماسنري="">
					<تكرار لكل="بطاقة" في="هدا.حالة.بطاقات">
						<عنصربطاقة صنف="مخطط-طولي فجوة-1 حشتح-4 مقوسكج ئطار1 حشس-3 ئطار-رمادي-600 تئشير:ضلملتف رمادي-500 ط-محتوا" معرف="_%{بطاقة._معرف}" عندنقر="عندنقرفتحبطاقة" بيا-معرف="%{بطاقة._معرف}" عنوانبطا="%{بطاقة.عنوان}" وحدة="%{بطاقة.وحدة}" محتوا="%{بطاقة.محتوا.قططع\(0، 100\) + '...'}"></عنصربطاقة>
					</تكرار>
				</شبكي>
			</قسم>
		</قسم>
		<طافية معرف="طافبطاقة" عنصر-بطاقة="خلف-حيادي-900" صنف="داكن" حجم="ملئ" تابتة></طافية>
	)؛
تم

ئعلن مدخل ():
	عنصرمخصص.سججل('مشهدبطاقات'، مشهدبطاقات)؛
تم
